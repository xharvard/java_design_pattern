clouda.define("mbaas/app",function(){function o(){return clouda.RUNTIME===clouda.RUNTIMES.KUANG&&clouda.PLATFORM===clouda.PLATFORMS.IOS&&"function"==typeof BLightApp.addLAPush?!0:!1}function a(o,a,c){var u={appid:c.appid,statis_ext:{src:"clouda"},push_action:a};c.nonce&&(u.nonce=c.nonce),c.csrftoken&&(u.csrftoken=c.csrftoken),c.tag&&(u.tags=[c.tag]);var i={push_params:u},d=function(){c.onsuccess(1)},s=function(o){c.onfail(o)};return n(o,JSON.stringify(i),d,s),!1}var c=clouda.lightapp,u=clouda.mbaas.app={},n=(clouda.mbaas||{},clouda.DelegateClass,clouda.kuangForReady,clouda.runtimeError,clouda.installPlugin,clouda.cloudaBLight),i=clouda.ErrCode,d=clouda.lib.utils.stat,s=function(o,a){var c=document.createElement("script");c.setAttribute("src",o),document.head.appendChild(c),c.onload=function(){a&&a(c)}};u.followSite=function(u,e){if(d({api:"app.followSite"}),u){var t="subscribeCallback"+ +new Date;if(window[t]=function(o){"undefined"!=typeof o.error_code&&0!==o.error_code?e.onfail(o):e.onsuccess(o)},clouda.PLATFORM===clouda.PLATFORMS.IOS){if(clouda.RUNTIME===clouda.RUNTIMES.KUANG&&clouda.RUNTIME_VERSION>="6.8"){var l=function(o){e.onsuccess(o)},p=function(o){e.onfail(o)};return e.appid=u,void n("followZhida",JSON.stringify(e),l,p)}return o()?(e.appid=u,void a("addLAPush","subscribe",e)):navigator.userAgent.match(/baiduboxapp\/([\d.-_]*)/i)&&clouda.RUNTIME!==clouda.RUNTIMES.KUANG?clouda.RUNTIME_VERSION<"6.1"?(e.onsuccess&&"function"==typeof e.onsuccess&&e.onsuccess(0),void clouda.lib.moplus.openApp(!1,u,{tip:"请使用最新版【手机百度】\n订阅",startDownload:1,platform:"ios"})):clouda.RUNTIME_VERSION>="6.1"&&clouda.RUNTIME_VERSION<"6.8"?void clouda.lib.moplus.openApp(!0,u):(e.appid=u,void s("https://pim.baidu.com/rest/2.0/im/zhidahao?method=subscribe&hsc=1&appid="+e.appid+"&sponsor=4&callback="+t,function(o){document.head.removeChild(o)})):clouda.RUNTIME===clouda.RUNTIMES.KUANG?(e.onsuccess&&"function"==typeof e.onsuccess&&e.onsuccess(0),void clouda.lib.moplus.openApp(!1,u,{tip:"请使用最新版【手机百度】\n订阅",startDownload:1,platform:"ios"})):(e.appid=u,void s("https://pim.baidu.com/rest/2.0/im/zhidahao?method=subscribe&hsc=1&appid="+e.appid+"&sponsor=4&callback="+t,function(o){document.head.removeChild(o)}))}if(clouda.RUNTIME===clouda.RUNTIMES.KUANG){if(clouda.RUNTIME_VERSION<"5.3")return e.onsuccess&&"function"==typeof e.onsuccess&&e.onsuccess(0),void clouda.lib.moplus.openApp(!1,u,{tip:"请使用最新版【手机百度】\n订阅",startDownload:1});if(clouda.RUNTIME_VERSION>="6.8"){var l=function(o){e.onsuccess(o)},p=function(o){e.onfail(o)};return e.appid=u,void n("followZhida",JSON.stringify(e),l,p)}return n("followSite",function(){e.onsuccess(clouda.STATUS.SUCCESS)},e.onfail),!1}if("undefined"!=typeof BLightApp||navigator.userAgent.match(/baiduboxapp\/([\d.-_]*)/i))return clouda.RUNTIME_VERSION>="5.3"&&clouda.RUNTIME_VERSION<"6.8"?void clouda.lib.moplus.openApp(!0,u):clouda.RUNTIME_VERSION>="6.8"?(e.appid=u,void s("https://pim.baidu.com/rest/2.0/im/zhidahao?method=subscribe&hsc=1&appid="+u+"&sponsor=4&callback="+t,function(o){document.head.removeChild(o)})):(e.onsuccess&&"function"==typeof e.onsuccess&&e.onsuccess(0),void clouda.lib.moplus.openApp(!1,u,{tip:"请使用最新版【手机百度】\n订阅",startDownload:1}));if(clouda.RUNTIME===clouda.RUNTIMES.LIGHTSDK){var r={appid:u||clouda.lightapp.appid,channel:e.src||"clouda",addShortcut:!1};return void clouda.lightsdk(e.onsuccess,e.onfail,"device.push","followSite",r)}if("undefined"!=typeof uix_bridge){var r={appid:u},f=clouda.lib.utils.regcallback(e.onsuccess,e.onfail);return void uix_bridge.followSite(JSON.stringify(r),f.s,f.f)}clouda.RUNTIME===clouda.RUNTIMES.NUWA&&clouda.NUWA_VERSION>="2.6"?nuwa&&nuwa.am&&"function"==typeof nuwa.am.subscribe?nuwa.am.subscribe(u,function(){e.onsuccess(clouda.STATUS.SUCCESS)},function(o){c.error(i.APP_ERROR,o,e)}):document.addEventListener("runtimeready",function(){nuwa.am.subscribe(u,function(){e.onsuccess(clouda.STATUS.SUCCESS)},function(o){c.error(i.APP_ERROR,o,e)})}):(e.appid=u,s("https://pim.baidu.com/rest/2.0/im/zhidahao?method=subscribe&hsc=1&appid="+e.appid+"&sponsor=4&callback="+t,function(o){document.head.removeChild(o)}))}},u.checkFollow=function(o,a){return o?clouda.RUNTIME===clouda.RUNTIMES.KUANG?(n("queryWzStatus",function(o){a.onsuccess(parseInt(o.status,10))},a.onfail),!1):void(clouda.RUNTIME===clouda.RUNTIMES.NUWA&&(nuwa&&nuwa.am&&"function"==typeof nuwa.am.hasSubscribed?nuwa.am.hasSubscribed(o,function(o){a.onsuccess(o?1:0)},function(o){c.error(i.APP_ERROR,o,a)}):document.addEventListener("runtimeready",function(){nuwa.am.hasSubscribed(o,function(o){a.onsuccess(o?1:0)},function(o){c.error(i.APP_ERROR,o,a)})}))):void c.error(i.UNKNOW_INPUT,i.UNKNOW_INPUT,a)},u.checkSupport=function(o){var a={};clouda.RUNTIME===clouda.RUNTIMES.NUWA?a["native"]=1:clouda.RUNTIME===clouda.RUNTIMES.KUANG?a["native"]=BLightApp&&"function"==typeof BLightApp.followSite?1:0:clouda.RUNTIME===clouda.RUNTIMES.WEB&&(a["native"]=0),a.web=0,o(a)}});
;clouda.define("mbaas/socialshare",function(){function e(e){var a=clouda.lightInit.ak||clouda.lightapp.ak,t=document.getElementsByClassName("bdSharePopup");if(1==e.hide){for(var c,d=0,u=t.length;u>d;d++)c=t[d],"block"==c.style.display&&(c.style.display="none");return!1}var s=function(e){var i=e.parentNode;i&&i.removeChild(e)};if(!e.content)return!1;for(var p=t.length,m=p-1;m>=0;m--)t[m]&&s(t[m]);e.linkUrl=e.linkUrl?e.linkUrl:location.href,e.linkUrl=n(e.linkUrl),console.log(e.linkUrl),e.linkUrl=encodeURIComponent(e.linkUrl),e.imageUrl=e.imageUrl?encodeURIComponent(e.imageUrl):"";var f={afterRender:function(){console.log("afterRender exec...")},client_id:a,dom_id:"hidden_btn",content:e.content,theme:"native",appid:e.appid?e.appid:"",animate:!1,url:e.linkUrl,pic_url:e.imageUrl,u:e.u};if(console.log(f),document.querySelector("#hidden_btn"))return o=document.getElementById("hidden_btn"),void socShare.init(f,function(){o.dispatchEvent(r)});var h;h="http:"===window.location.protocol?"http://apps.bdimg.com":"https://openapi.baidu.com";var U=2;i(h+"/cloudaapi/socialshare-api/share.min.js?a="+U,function(){var i=["weixin_friend","weixin_timeline","qqfriend","sinaweibo","qqweibo","qqdenglu","renren","sms","email"];if(e.mediaType&&"all"!==e.mediaType){for(var n=!1,t=0,c=i.length;c>t;t++)if(i[t]==e.mediaType){n=!0;break}if(n)return void("weixin_friend"==e.mediaType||"weixin_timeline"==e.mediaType||"qqfriend"==e.mediaType?clouda.lib.moplus.openApp(!0,f.appid):"sinaweibo"==e.mediaType||"qqweibo"==e.mediaType||"renren"==e.mediaType?location.href="http://openapi.baidu.com/social/widget/share?method=share&media_type="+e.mediaType+"&client_id="+a+"&url="+e.linkUrl+"&pic_url="+e.imageUrl+"&content="+encodeURIComponent(e.content)+"&u="+e.linkUrl:"qqdenglu"==e.mediaType?location.href=socShare.acc.getQQHref(f):("sms"==e.mediaType||"email"==e.mediaType)&&socShare.acc.getShortLink({client_id:a,url:e.linkUrl},function(){var i=socShare.acc.shortLinks[e.mediaType];location.href="sms"==e.mediaType?socShare.acc.getSMSHref(e.content,i):socShare.acc.getEmailHref(e.content,i)}))}l=!0,document.querySelector("#hidden_btn")?console.log("js 加载失败"):(o=document.createElement("div"),o.id="hidden_btn",o.style.display="none",document.body.appendChild(o),socShare.init(f,function(){o.dispatchEvent(r)}))})}function i(e,i){var n,a,t,o=document.head||document.getElementsByTagName("head")[0]||document.documentElement;"object"==typeof e&&(a=e,e=void 0),t=a||{},e=e||t.url,i=i||t.success,n=document.createElement("script"),n.id="share_script",n.async=t.async||!1,n.type="text/javascript",n.charset=t.charset?t.charset:"utf-8",n.src=e,o.insertBefore(n,o.firstChild),"function"==typeof i&&(document.addEventListener?n.addEventListener("load",i,!1):n.onreadystatechange=function(){/loaded|complete/.test(n.readyState)&&(n.onreadystatechange=null,i())})}function n(e){var i=e,n=e.match(/^(http:\/\/|https:\/\/)?(.+\?)/i);if(n){for(var a=e.substring(n[0].length),t=a.split("&"),o=[],r=0;r<t.length;r++)t[r].match(/^bd_/)||o.push(t[r]);i=n[0]+o.join("&")}return i}{var a=(clouda.mbaas||{},clouda.lightapp),t=clouda.mbaas.socialshare={};clouda.DelegateClass,clouda.kuangForReady,clouda.runtimeError,clouda.installPlugin,clouda.cloudaBLight}t.loadFlag=1;var o=null,r=document.createEvent("HTMLEvents");r.initEvent("click",!1,!1),r.eventType="message";var l=!1;return t.callShare=function(i){if(clouda.lib.utils.stat({api:"socialshare.callShare"}),clouda.RUNTIME===clouda.RUNTIMES.KUANG&&BLightApp&&"function"==typeof BLightApp.callShare||navigator.userAgent.match(/baiduboxapp\/([\d+.]+)/)&&clouda.RUNTIME_VERSION>="5.3.5"){if(1==i.hide)return!1;if(!i.onsuccess||!i.onfail||"function"!=typeof i.onsuccess||"function"!=typeof i.onfail)return a.error(ErrCode.UNKNOW_INPUT,ErrCode.UNKNOW_INPUT,i),!1;if(!i.content)return a.error(ErrCode.UNKNOW_INPUT,ErrCode.UNKNOW_INPUT,i),!1;if(!i.mediaType)return a.error(ErrCode.UNKNOW_INPUT,ErrCode.UNKNOW_INPUT,i),!1;i.title||(i.title="来自手机百度"),i.linkUrl||(i.linkUrl=location.href),i.linkUrl=n(i.linkUrl);var t=clouda.lib.utils.regcallback(i.onsuccess,i.onfail);if(clouda.RUNTIME===clouda.RUNTIMES.KUANG)BLightApp.callShare(JSON.stringify(i),t.s,t.f);else if("undefined"!=typeof Bdbox_android_utils&&"undefined"!=typeof Bdbox_android_utils.callShare)Bdbox_android_utils.callShare(JSON.stringify(i),t.s,t.f);else if(clouda.PLATFORM===clouda.PLATFORMS.IOS){var o="baiduboxapp://callShare?options="+encodeURIComponent(JSON.stringify(i))+"&errorcallback="+t.f+"&successcallback="+t.s;location.href=o}return!1}if(clouda.RUNTIME===clouda.RUNTIMES.LIGHTSDK){var r=i.mediaType||"all",l={all:0,sinaweibo:1,weixin_friend:2,weixin_timeline:3,sms:4},c={title:i.title||document.title,url:n(i.linkUrl||location.href),content:i.content||"这个直达号很赞，马上用百度地图体验一下吧。",img_url:i.imageUrl,weixin_description:i.title||"这个直达号很赞，马上用百度地图体验一下吧。",thumb_img_url:i.iconUrl||i.imageUrl,weixin_send_url:!0,fromSmartBar:!0};return c.weibo_title=c.weixin_title=c.weixin_timeline_title=i.title,c.share_type=l[r]||0,void clouda.lightsdk(i.onsuccess,i.onfail,"device.share","directShare",c)}if("undefined"!=typeof uix_bridge){var t=clouda.lib.utils.regcallback(i.onsuccess,i.onfail);return void uix_bridge.callShare(JSON.stringify(i),t.s,t.f)}if(clouda.RUNTIME===clouda.RUNTIMES.NUWA&&clouda.NUWA_VERSION>="2.6"){{clouda.lightInit.ak||clouda.lightapp.ak}0!==i.menumode&&(i.menumode=1),i.linkUrl=i.linkUrl||location.href,i.imageUrl=i.imageUrl||"",i.mediaType=i.mediaType||"all";var d=function(){i.onsuccess(clouda.STATUS.SUCCESS)},u=function(){a.error(ErrCode.BTY_ERR,nativeErr,i)};return nuwa&&nuwa.sm&&"function"==typeof nuwa.sm.share?nuwa.sm.share(d,u,JSON.stringify(i)):document.addEventListener("runtimeready",function(){nuwa.sm.share(d,u,JSON.stringify(i))}),!1}return e(i),!1},t.checkSupport=function(e){var i={};clouda.RUNTIME===clouda.RUNTIMES.NUWA?i["native"]=0:clouda.RUNTIME===clouda.RUNTIMES.KUANG?i["native"]=BLightApp&&"function"==typeof BLightApp.callShare?1:0:clouda.RUNTIME===clouda.RUNTIMES.WEB&&(i["native"]=navigator.userAgent.match(/baiduboxapp\/([\d+.]+)/)&&clouda.RUNTIME_VERSION>="5.3.5"?1:0),i.web=1,e(i)},t});